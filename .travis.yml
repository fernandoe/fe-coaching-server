language: generic
sudo: required
services:
- docker

env:
  global:
  - secure: x0igBIUtamXX/IhPxKBXf70u/jEVUgiTOFa4JPmidw/4Ag604IuSvnPufl4M/Y8un2/QAtjuQ5mcqEU0lXWoncypHQ7Vb3XI9Y+TcdfAoHd2SQHVdHLmgiOJBafSJgMwI2gL6UUcAg0AgUuuN2QYyJz7eAp7lLBN7WBJlqyfjTdcLrnIshk7ctYnLwGAykQ7cIbIuAZ0FzOvNRxq3u1pcbKGI44y3pY01ZrEiRrpTu/wHPZWtnYmCu4kAUorm8FDHvHpIp3KMfe4n+W0kdiIL4z9fUklis0uil/S9Beb3WKmoMK2PBypsj3d248dT8N2ybyIiQCYmOhzC3tGH/YbiE8iYm4n09kKNoKxrykU/k6a4M3hWnbcBDG5MY+9Bb5jvV4wKNVBf8wmFo0SCKirwu5zzjj/siRDUHAtQhfJfIfZct3kteSWIB+ZvGg7u2Na/V6vfrWNtui8HUvYCUMdHwwxZIfdLJVhnIToLrS+LU5dJ6XSYkeGi3EKg/c2bfMjsBw2L1H5hccCKwHhe0eGoettP8pR8IpjyMmsFyKlzCoEa+GEh28YSFKBF+sg/PQf9mc3FzcSAZU09bKvY8EO65hq2mPAvFm+yXB3oHpOD7GNQhdvqvTW8ZD3orrmC1AOeK141FiZ60rqlVzmPMe+mBm3MSx/EnxRWLK5fCYlGpY=
  - secure: 0k7lktGmQ5iAwslHVp1uw63uK0dF2zshsDsZRZFAG/gKkGrqFAhntDzkieG/qcUahOf43VyilFzaKTA2rM8ts/x6HAgzJm+WUQSbYXEG8pdrHkyA2Wepv4U4ouqjOV9bTWBkBbN3bjZVw7qdCtP5Jy3CBV2Frwz9H05cZIU9v5Sgg+6Y8yUq/K9q9spiaq012rh3Eo9iQ4+DjAvX9T3b0upHDaL7Kk3qYrxKR0/jKfJdFK5suKwY38Pd77UeuiKc8aDc8k58FyEiEXbDI/HbzMGazsKxk8W9lmnGuHo9kDbHeRIODgrM33/G76VlwdsRIXp7NzblsovGhgzk6Lf0YdbKtAUC0qEKs7vM/vImckEYf5iH/4VvdobWNGO5CA1FPouCaT/VqpaF4ECQvmFug/OpoyoWphMlT/ua72kYeN6mJHgRqN4LaZ8mhPMe+XDmkCPZ4mwdLHtn9Tuke7/td5Ofrs0PG9gCxYeND+OmpDTYfmxcwt/SZ13Eg9xufUJDxiIJFx4YEnIIYVH8DdElT3+4b7geZ02SfrclufsI//w3EcCDtS5IVm62oJiY78O7ppNnExu5R1c/IX4zJetwyZSgxnNQvSXF82bxBpF7/YvXRLVFCwpujl2qpcQIZo/r3gHjkeX7i8Vtw4FvnRhM2BdDPhTesWGWCzRUG+t3GUU=
  - secure: U8w3NKXMob9bg0KhJVf5HhoNoImr4T8aRELqMs5xmCRSbTYgGuN8YhbgW2KGIMtBgQZnoYolWxFwc1DQO+Fy542m3NGzR5ydhNQCujGjvSiYzqVUWqVEKbOYQK0nSeQnNFnQRZ4SQ4x2fIvZv2OTL3jUBSqXxKr72P+RiCj3PbSDw0hfZvtqjBeqE+PSkQDwUzkRJDIqiHIpZiktYRSzb9EVBTj9/3NJXV8tacUx21CbZKx9DjzlLaJehZtmiWWKpLvmV7Vlfu9/9DdI9B6pJxGXgQcCdFtfeaB7PiMGdKUWOedJ34mtzdHdMqN424mBfGs2GbToQxRww4aGwtY4kOuWKvjA6jlPzLdJioZyl0wm7sDnZFcp7mlQoCxksvF/QF9WuZqiZ+jZJ7BkWZie4I+rXhpUBAuJsh0T2FCZU3PHEFRui5qy5uAqWRrc6D1QRQ4h1fX1h5lCLdTy9U9166DYCBjNJOWKLbuy6P+9eNwOdJpxwKqI/cxCSrL6u7kkOwZJToMh8Bg3PvXPVPKPTxTtU8HFTXTTuaqJwG/r4CKgk6xpAKfbD23l19RUD691Z2aOGhLtgb3FQWSSUWBAnb8huqNbGhkzexK5MJdzajiMHKIs5nrrCR6Sw+X9O5VBYeWj9QoKxfc6fdfQrSZiSHNKkVNRZYFncQVCbBIUhIU=
  - secure: 8RgCTlGb32cYvi33H8eAeBYL0FDOQ31MijDJ5cPZ3W4ysqWJanFLyKgNz9xiJGXbKJA/wC9RvMCqPI6U2kYj+nR05z2rZrX5pAfNXW6Eb8NhFzXOuk+5aQLw1kQW9pyzrNtEE+l+LQAD+DeVYDG3E/jDJ+BpbiPLSHZg99FAGewV12LPWvIP1aEPi59De32TWvvQUa0aEsc9s0Bw34BRoERSHO1631+acsNOaPoVFFrBXHp/5YpR1rALng+GbyBJKrSU/OwzJjj8+IuRWlMDjjH7LHgDRc3YjXvTWfDHR0u1JPbxWG4n9yRALJJn9qeZrA1Xpkc5o0P89Yyw8UsWXXdHy3sf191JdhgJ0zCuqm1rvjjd9x3FSyDBroGndksKltPSUoaml7LKCXQSZ1ov+f4nc+FgNlOVSE1osW935Ac/Lp1H234lPKDz7piC35AJns1KSnk7LmovWXW2QYoJPsiX+zvh7ORXE7z1k46PLvh6/jxs7Bxp8ObiXge+rLcWeWmtI86brzKBtARrOaJVkXYE3hgC15DC+ya1crmbiPg0CuhjIKgfFdTB47DHv/U7U5VcD6FgZaPjlYw8Y/dP9xhYsGN7PpoPnzWuScRPudI5Pandu3auZSd3UIgMvS9pCiFBgn+r5IJPntqPZ1HfHfUzJlijbtxuH2UVpJuL6KM=
  - secure: hW7y3vXqXrijBFTFaniXuBwJIRyLNJ87/vfbjC0WZnGvsngvhC7zbHmcReB2DZEdZFYafsxNGLRXukSZg3cX3+1ZexGYCm/xBh8I7WOQu/1yccieKxrNu1ZG/8z4ZvYJiIxDBXIJy4V/x4T3mUw93GQI4agorBVCAZjEZgPPZ1PQYAA4I+PMxsiTv5T+n9IdK+aEbFxzblqdI3iOZ/KyjQPAjGvhIpaayi1aK0MejiadFhZJ1CszHD5VtPz+qaVG9zy3caTZSqt/w6aOU/p1PWpghRf/pcpFIqj7cY+0p1WkIV35ANrM7vG1lKOdzwVippKaXbYN6SYszjCyQQzNqpCAUgILuInz85k36Ea2lF18C1zr/pYj1GNt9Yzbz1UXeYLHhGCWnMq4zXsGUcZxyg70s8aSPydFTUds1LGKESOMkO7hvIXo6Uly1ZlJ82f7J1Jw7eWvOl3daJOlIdp+iXwTQRHOpBRLnEtJkl3xafCWnoPBZeifdNRQpTgqAmwkubDQ13WYJN4ctWwO/XFwgzQb+ApLMjOlZYo6llHF0TOGFI8Kl6gcDEIRxJOJDK67NLPdp+esJ/x7BcFxGHJE9FUtqTwWO3r/AjoNTHI8nuBl5DUZaxZwI3A/8oQcLxqa9wz/04H8U11PCXu1GlT/ONNtVb0IwfTHN/7g3nXq2N4=
  - secure: kF9gYGPHiGEGS6ifTfKE2cQGv08i1mclA5tqtDSa0vg4HwRpzoJkEuSss+XN3KoKGbW0jVQVaslF/8YdzWxS0vt6mo1qyRz94RSkzmKkFNyhGyvUQnVKtXpQtuG5QlnuDLxC9tAB8tlPGfLfVO1q8lgJ8cdNrH9jr0nhGBCLxW7XXfzrjth14vq1M58iu6foACSLS+z0FfhFFyE+7hEZYBvYUFvFrchiKlOvSQjvAEhvM8+dcGoqi+HgYGs3rjRh12NC//5bjUliuKWiZzXECeuTg+oTqatfMbg4UjVVQaBI6bBWqP5zJehpIZ1LLLojK5jle8wA0K0DldGqxQgEttpF/0R51OBvcvg1GDf869UyBcnEhitzRexGDhEuSE5k9ByAwW8WZuY4Z2OZEuLCI9folB3LVGwMcO1bxcmdtxkNL+G8WTBDfNMVH5zW6PeG8xCJTBDyckhIDH0T2TL89rshvj6phozzXQpkQthiucvS/yAZ9IYi2A2kdFKlnqmiP4GWfVOvH+9JJvlbUy8ZrfOV7kuGx5O5a08eARFVVN27Z8bYgKskOuL3HBiH0ijKwlIUSNi2ULChR5nKzutiC4abOK8xKeeTUxNzwIwFko9Vf90XNgv4tM+uKEdCAS8/39p4zWnrvVS7cHKsFCvCFbOQ2auNCwMF+1fIjAjCQ2U=
  - secure: EDGiEElctJUU8laLv+o2uP28xDoyS64Ku8Bd16ZzT4gyQQWPpvlzU6abXP6BqfqrCvmMB4RU4d8xv0PxbVpUU+UWpm06M8/DWlpqzASi2LoAiWacWg/kWSfU5wrZIFbRcYnRC/Urn8U8ki2lNzPI+N3h6qvuv3oWOdzVSTuYNpc8ACeS3bsHwXnZeM2G7kTHjSK07DV8l0E85GkIlQtlwXFznUeSyq5N6iYrYVNr/80lRPn4sy5JybXZ1pdW9qkVLqQgSULDA59FYIySvKpNb61k/PLABEU41s7JPVUHFjRfM+OaIatjz7eG68jMgWjisLE2Z2wbmaUOKLKM+Tf6G4LWpo0WNnIiFYII+OA9CxSFRcVf9oKTbKGdyogECFwlOIgVjQ/2oLNbtRUEtCC+zROt4rNVfDFCIn79os1BcxvX6k1aS1Io6T17NgQb04+FDUTnxmVz+OfYUTHtHyJURMVMZxu5FJ8LUOxZWbTPCi4hcc/0zR3PmGVQFBc64sdr83lgV2Or8a0Z1QJAehpQzbZqNiIzTVAZXa/okVZnKBFT0gyoQ25bw/1eS4/ReAGcKaVNPVRV0+dHE/03DLlZw1mPKNrkufNCdgIcu1bRzkoC49EsnTTCyRFNuftj/8UYfeLwR8nG2Xwx+gis1ZD3r9yl3CBGOTe+j5nP2CTRLlw=
  - secure: CEm09YmfbzfBZix1JhnVi0en7Ypdl3ESI+4AuUrUf33VdDMs+YoYYu87GKOISuJA3bY2DSt081TWT9htSA6qCAkYuRoA3s/HFuBOGuBxdXZCW8fMG1lBIeZf0THCUEpssqvIFohMsSGmSNvnfPggYCdVgIp1V4Nu4cEmJHbNNfPoMu9uUXZIuNhv2MUFxpqDDEj8/XY6Qew8UimKCUzcyzfO91m2oAwO5a2fk4vdoz49V2RYTSQnr4XSPgTnM0CYptl5UNria3uB/WS0x33QS0kVkZy2KzrZNhnGemt3lWRjZbnC+ic7Oc20tHxsnnMCKuEwwjjhmiQJ3F72b+QKss87FoF0imGewVLH3fYVj4C05tB7p1z6+f3uDO6HZrkcmlx8xn0OluOgvwaTym5vYDwu+XjxU7+qugKh1LVjpctNSnuncFFFdC/dVhM78Mz6A/DKmK8Ht6zdDDPkS5Q24mohksA3GzMvpX3/v7TzCwsXpGrVo6AdvSvrXpyzTKf2qlBGT4lpSD5ls7vupqpUGgISojVC+kjllS5Q5tdmvm17ovHsEa3zyG6pw7vopQdngeoDdcTpw3JTEKHyGfKCouUs4Of1KqaurKKTX5qwgBD0yzfNNSwW4LXloLOjMVTFACib71glkhHrZwQII9JGm3zKMvmDYj6OBabvuj8L+Mk=

before_install:
  - echo "$DOCKER_PASS" | docker login -u $DOCKER_USER --password-stdin

install:
  - export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH ; fi`
  - docker build -f Dockerfile -t $TRAVIS_REPO_SLUG:$TAG .

script:
  - make travis.test

after_success:
  - docker push $TRAVIS_REPO_SLUG

deploy:
  skip_cleanup: true
  provider: script
  script:
    - ./scripts/deploy.sh
  on:
    tags: true
    branch:
      - master
#      - feature-codigo-minimo-para-rodar
      - /(\d+\.)?(\d+\.)?(\*|\d+)$/
